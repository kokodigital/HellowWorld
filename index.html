<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script src="phonegap.js"></script>
<script src="childbrowser.js"></script>
<script src="cdv-plugin-fb-connect.js"></script>
<script src="facebook-js-sdk.js"></script>
<script>
function launchBrowser() {
alert((window.plugins.childBrowser != undefined) + " should be true")
window.plugins.childBrowser.showWebPage('http://www.phonegap.com',
{ showLocationBar: true });
}

document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {
 console.log('1');
  FB.init({
    appId : auth.fbId,
    nativeInterface : CDV.FB,
    useCachedDialogs : false
  });
  console.log('2');
   console.log(FB);
}

function login() {
	    console.log('1');
                FB.login(
                         function(response) {
                         if (response.session) {
                         alert('logged in');
						 console.log('2');
                         } else {
                         alert('not logged in');
						  console.log('3');
                         }
                         },
                         { scope: "email" }
                         );
            }
var auth = new function() {

  this.fbId = "628828893800003";

  this.FBlogin = function() {

    FB.login(function(response) {

 var uid = null; 
 try {
     uid = response.authResponse.userId;
 } catch (e) {
     main.errorLog(e, "FB.login");
 }

 // iOs Hack other property name
 if (!uid && navigator.userAgent.match(/(iPhone)/i)) {
    try {
       uid = response.authResponse.userID;
    } catch (e) {
       main.errorLog(e, "FB.login");
    }
 }

 if (response.status == 'connected') {
   main.loadAjax(main.ajaxPrefix + '/auth/loginsocial/', {
     fbId : uid,
     access_token: response.authResponse.accessToken,
            secret: TOP_SECRET_GENERATED_HASH
   }, auth.successLogin, auth.errorLogin);

 } else if (response.status === 'not_authorized') {
    alert('Error in authentication: not authorized');
 } else {
    alert('Unknown error in authentication');
 }
    }, {scope : "email"});
  }
}			
			
			

</script>
</head>
<body>
<h1>Plugin tests</h1>
 
<a onClick="launchBrowser()" href="#">Child Browser</a>
<a onClick="auth.FBlogin();" href="#">facebook</a>

 
</body>

</html>